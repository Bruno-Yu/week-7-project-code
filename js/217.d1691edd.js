"use strict";(self["webpackChunkweek_7_project"]=self["webpackChunkweek_7_project"]||[]).push([[217],{3217:function(e,t,a){a.r(t),a.d(t,{default:function(){return G}});var s=a(6252),l=a(9963),o=a(3577);const r={class:"container"},i={class:"mt-4"},n={class:"text-end"},d=["disabled"],u={class:"spinner-grow spinner-grow-sm"},c=(0,s.Uk)("清空購物車 "),m={class:"table align-middle"},p=(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("th"),(0,s._)("th",null,"預覽圖"),(0,s._)("th",null,"品名"),(0,s._)("th",{style:{width:"150px"}},"數量/單位"),(0,s._)("th",{class:"text-end"},"單價/總價")])],-1),h={key:0},b=["onClick","disabled"],g={class:"spinner-grow spinner-grow-sm"},_=(0,s.Uk)(" x "),f={class:"fw-bolder text-decoration-underline"},v={class:"input-group input-group-sm"},y={class:"input-group mb-3"},w=["onUpdate:modelValue","onChange","disabled"],C=["value"],k={class:"input-group-text",id:"basic-addon2"},x={class:"text-end"},I={class:"spinner-grow spinner-grow-sm"},L={class:"text-secondary fz-sm"},V={class:"fw-bolder"},$=(0,s._)("td",null,null,-1),D=(0,s._)("td",{colspan:"3",class:"text-end"},"總計",-1),U={class:"text-end"},W={class:"my-5 row justify-content-center"},q={class:"mb-3"},z=(0,s._)("label",{for:"email",class:"form-label"}," Email ",-1),A={class:"mb-3"},j=(0,s._)("label",{for:"name",class:"form-label"},"收件人姓名",-1),E={class:"mb-3"},F=(0,s._)("label",{for:"tel",class:"form-label"},"收件人電話",-1),S={class:"mb-3"},H=(0,s._)("label",{for:"address",class:"form-label"},"收件人地址",-1),K={class:"mb-3"},P=(0,s._)("label",{for:"message",class:"form-label"},"留言",-1),Y={class:"text-end"},M=["disabled"];function O(e,t,a,O,T,Z){const B=(0,s.up)("v-field"),G=(0,s.up)("error-message"),J=(0,s.up)("v-form");return(0,s.wg)(),(0,s.iD)("div",r,[(0,s._)("div",i,[(0,s._)("div",n,[(0,s._)("button",{class:"btn btn-outline-danger",type:"button",onClick:t[0]||(t[0]=(...e)=>Z.removeCartAll&&Z.removeCartAll(...e)),disabled:"deleteAll"===T.isLoadingItem||0===T.cartData.carts.length},[(0,s.wy)((0,s._)("span",u,null,512),[[l.F8,"deleteAll"===T.isLoadingItem]]),c],8,d)]),(0,s._)("table",m,[p,(0,s._)("tbody",null,[T.cartData.carts?((0,s.wg)(),(0,s.iD)("div",h,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(T.cartData.carts,(e=>((0,s.wg)(),(0,s.iD)("tr",{key:e.product.id},[(0,s._)("td",null,[(0,s._)("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:t=>Z.removeCartItem(e.id),disabled:T.isLoadingItem===e.id},[(0,s.wy)((0,s._)("span",g,null,512),[[l.F8,T.isLoadingItem===e.id]]),_],8,b)]),(0,s._)("td",null,[(0,s._)("div",{style:(0,o.j5)([{height:"100px","background-size":"cover","background-position":"center"},{backgroundImage:`url(${e.product.imageUrl})`}])},null,4)]),(0,s._)("td",f,(0,o.zw)(e.product.title),1),(0,s._)("td",null,[(0,s._)("div",v,[(0,s._)("div",y,[(0,s.wy)((0,s._)("select",{id:"",class:"form-select","onUpdate:modelValue":t=>e.qty=t,onChange:t=>Z.updateCartItem(e),disabled:T.isLoadingItem===e.id},[((0,s.wg)(),(0,s.iD)(s.HY,null,(0,s.Ko)(20,(t=>(0,s._)("option",{value:t,key:`${t}-${e.id}`},(0,o.zw)(t),9,C))),64))],40,w),[[l.bM,e.qty]]),(0,s._)("span",k,(0,o.zw)(e.product.unit),1)])])]),(0,s._)("td",x,[(0,s.wy)((0,s._)("span",I,null,512),[[l.F8,T.isLoadingItem===e.id]]),(0,s._)("span",L,"單價 "+(0,o.zw)(e.product.price)+"元 /",1),(0,s._)("span",V," 總價"+(0,o.zw)(e.total)+"元 ",1)])])))),128))])):(0,s.kq)("",!0)]),(0,s._)("tfoot",null,[(0,s._)("tr",null,[$,D,(0,s._)("td",U,(0,o.zw)(T.cartData.total)+"元",1)])])])]),(0,s._)("div",W,[(0,s.Wm)(J,{ref:"form",class:"col-md-6",onSubmit:Z.onSubmit},{default:(0,s.w5)((({errors:e})=>[(0,s._)("div",q,[z,(0,s.Wm)(B,{id:"email",name:"email",type:"email",class:(0,o.C_)(["form-control",{"is-invalid":e["email"]}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:T.form.user.email,"onUpdate:modelValue":t[1]||(t[1]=e=>T.form.user.email=e)},null,8,["class","modelValue"]),(0,s.Wm)(G,{name:"email",class:"invalid-feedback"})]),(0,s._)("div",A,[j,(0,s.Wm)(B,{id:"name",name:"姓名",type:"text",class:(0,o.C_)(["form-control",{"is-invalid":e["姓名"]}]),placeholder:"請輸入姓名",rules:Z.noEmpty,modelValue:T.form.user.name,"onUpdate:modelValue":t[2]||(t[2]=e=>T.form.user.name=e)},null,8,["class","rules","modelValue"]),(0,s.Wm)(G,{name:"姓名",class:"invalid-feedback"})]),(0,s._)("div",E,[F,(0,s.Wm)(B,{id:"tel",name:"電話",type:"text",class:(0,o.C_)(["form-control",{"is-invalid":e["電話"]}]),placeholder:"請輸入電話",rules:Z.isPhone,modelValue:T.form.user.tel,"onUpdate:modelValue":t[3]||(t[3]=e=>T.form.user.tel=e)},null,8,["class","rules","modelValue"]),(0,s.Wm)(G,{name:"電話",class:"invalid-feedback"})]),(0,s._)("div",S,[H,(0,s.Wm)(B,{id:"address",name:"地址",type:"text",class:(0,o.C_)(["form-control",{"is-invalid":e["地址"]}]),placeholder:"請輸入地址",rules:Z.noEmpty,modelValue:T.form.user.address,"onUpdate:modelValue":t[4]||(t[4]=e=>T.form.user.address=e)},null,8,["class","rules","modelValue"]),(0,s.Wm)(G,{name:"地址",class:"invalid-feedback"})]),(0,s._)("div",K,[P,(0,s.wy)((0,s._)("textarea",{id:"message",class:"form-control",cols:"30",rows:"10",rules:{required:!1},"onUpdate:modelValue":t[5]||(t[5]=e=>T.form.message=e)},null,512),[[l.nr,T.form.message]])]),(0,s._)("div",Y,[(0,s._)("button",{type:"submit",class:"btn btn-danger",disabled:Object.keys(e).length>0||0===T.cartData.carts.length}," 送出訂單 ",8,M)])])),_:1},8,["onSubmit"])])])}var T={data(){return{cartData:{carts:[]},products:[],productId:"",isLoadingItem:"",form:{user:{name:"",email:"",tel:"",address:""},message:""}}},methods:{getCart(){this.$http.get("https://vue3-course-api.hexschool.io/v2//api/brunoyu2022/cart").then((e=>{console.log(e),this.cartData=e.data.data}))},addToCart(e,t=1){const a={product_id:e,qty:t};this.isLoadingItem=e,this.$http.post("https://vue3-course-api.hexschool.io/v2//api/brunoyu2022/cart",{data:a}).then((()=>{this.getCart(),this.isLoadingItem=""}))},removeCartItem(e){this.isLoadingItem=e,this.$http.delete(`https://vue3-course-api.hexschool.io/v2//api/brunoyu2022/cart/${e}`).then((()=>{this.getCart(),this.isLoadingItem=""}))},removeCartAll(){this.isLoadingItem="deleteAll",this.$http.delete("https://vue3-course-api.hexschool.io/v2//api/brunoyu2022/carts").then((()=>{this.getCart(),this.isLoadingItem=""}))},updateCartItem(e){const t={product_id:e.product.id,qty:e.qty};this.isLoadingItem=e.id,this.$http.put(`https://vue3-course-api.hexschool.io/v2//api/brunoyu2022/cart/${e.id}`,{data:t}).then((()=>{this.getCart(),this.isLoadingItem=""}))},onSubmit(){const e="https://vue3-course-api.hexschool.io/v2//api/brunoyu2022/order",t=this.form;this.$http.post(e,{data:t}).then((e=>{alert(e.data.message),this.$refs.form.resetForm(),this.getCart()}))},noEmpty(e){return!!e||"此欄不得為空"},isPhone(e){const t=/^(09)[0-9]{8}$/;return!!t.test(e)||"需要正確的電話號碼"}},mounted(){this.getCart()}},Z=a(3744);const B=(0,Z.Z)(T,[["render",O]]);var G=B}}]);
//# sourceMappingURL=217.d1691edd.js.map